node: azazel-pi-01
interfaces:
  lan: wlan0
  wan: wlan1
  # 外部（アップリンク）として扱うインターフェースの明示（複数可）
  # 注意: これらは例です。ランタイムでの自動選択を優先する場合は
  # 環境変数 `AZAZEL_WAN_IF` (単一) または `AZAZEL_WAN_CANDIDATES` (カンマ区切り) を使用して
  # 実行時に優先するインターフェースを指定できます。
  external: ["eth0", "wlan1"]
profiles:
  active: lte
  sat:   { uplink_kbps: 2000, rtt_ms: 700 }
  lte:   { uplink_kbps: 5000, rtt_ms: 80 }
  fiber: { uplink_kbps: 50000, rtt_ms: 10 }
qos:
  medical: { dest_fqdns: ["emis.example.org"], dest_cidrs: ["203.0.113.0/24"] }
  ops: { ports: [22,443,853] }
  public: {}
soc:
  suricata_ruleset: balanced
  canary_services: ["ssh", "http", "pgsql"]
  denylist_ips: []  # 即時遮断対象IP（例: ["1.2.3.4", "5.6.7.8"]）
  critical_signatures:  # 即時遮断対象シグネチャ
    - "ET EXPLOIT"
    - "ET MALWARE"
    - "ET TROJAN"
    - "Critical Infrastructure Attack"
canary:
  # OpenCanary honeypot IP address (direct container IP)
  ip: "172.16.10.3"
  port: 2222  # OpenCanary SSH port
actions:
  normal:   { delay_ms: 0,   shape_kbps: null, block: false }
  portal:   { delay_ms: 0,   shape_kbps: null, block: false }
  shield:   { delay_ms: 100, shape_kbps: 128,  block: false }
  lockdown: { delay_ms: 150, shape_kbps: 64,   block: true  }
thresholds:
  t0_normal: 20
  t1_shield: 30
  t2_lockdown: 70
  # Shortened unlock windows for verification testing. Revert after test.
  unlock_wait_secs: { shield: 30, portal: 90 }
  user_mode_timeout_mins: 3.0
notify: { level: warn }
storage: { log_dir: "/var/log/azazel", retain_days: 14 }
privacy: { pii_minimize: true, hash_fields: ["src.ip", "dst.ip", "username"] }

# QoS internal network control (premium/standard/best_effort/restricted)
wan_iface: "eth0"     # shaping target interface (can mirror 'interfaces.wan')
# Runtime note: to override the shaping target at runtime set AZAZEL_WAN_IF env var
#   export AZAZEL_WAN_IF=wlan1
lan_iface: "br0"      # LAN bridge for ARP pinning when MODE=lock
mark_map:
  premium:    0x10
  standard:   0x20
  best_effort: 0x30
  restricted: 0x40
classes:
  premium:     { rate_kbps: 50000, ceil_kbps: 50000 }
  standard:    { rate_kbps: 20000, ceil_kbps: 40000 }
  best_effort: { rate_kbps:  5000, ceil_kbps: 10000 }
  restricted:  { rate_kbps:  1000, ceil_kbps:  2000 }
priority_thresholds:
  ge_90: premium
  ge_60: standard
  ge_30: best_effort
  lt_30: restricted
dynamic_bias:
  factor: 0.5
  max_delta: 80
  min_priority: 10
